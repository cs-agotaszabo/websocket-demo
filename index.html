<!doctype html>
<html>
<head>
	<meta charset='utf-8'>
	<title>WebSocket Client</title>
</head>
<body>
<h1>WebSocket Client</h1>
<p>Open your web console to see the response!</p>
<form>
  <label for="message">Send a message</label>
  <input id="message" name="message" type="text">
  <button id="send" name="send">Send</button>
</form>

<!-- latest jQuery -->
<script src="http://code.jquery.com/jquery-latest.min.js"></script>

<script>
var ws = new WebSocket("ws://localhost:1337");

ws.onopen = function(ev) {
  console.log('Connection opened.');
}

ws.onmessage = function(ev) {
  console.log('Response from server: ' + ev.data);
}

ws.onclose = function(ev) {
  console.log('Connection closed.');
}

ws.onerror = function(ev) {
  console.log('An error occurred. Sorry for that.');
}

WebSocket.prototype.sendMessage = function(msg) {
  this.send(msg);
  console.log('Message sent: ' + msg);
}

var sendBtn = document.getElementById('send');
var message = document.getElementById('message').value;

sendBtn.addEventListener('click', function(ev) {
  ws.sendMessage(message);
  ev.preventDefault();
});

/*
$('#send').on('click', function(ev) {
  ws.sendMessage( $('#message').val() );
  ev.preventDefault();
});
*/
</script>
</body>
</html>